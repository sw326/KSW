# < PL - SQL >

1. Procedure
	1) 설명
		일련의 '작업 처리 순서를 정의'해 놓은 것으로 미리 DBMS에 컴파일 되어져 있어 '프로그램 or 사용자'로부터 호출되면 실행되는 일종의 '알고리즘'
		
		-- 사원번호와 급여인상률을 넣으면 해당사원의 급여가 인상되는 프로시저
		
	2) 예
	   pro1.sql, pro2.sql
	   
	3) 
2. Trigger
	1) 설명
	2) create [ or replace ] trigger 트리거명
	   before | after
		   [ 동작( inseert, update, delete )] on 테이블명
		   [ referencing new | old tables as 테이블명 ]
		   [ for each row ]
		   [when 조건식 ]
	   begin
		   로직
	   end;
	   /
	   
	3) 예: tri1.sql, tri2.sql
		drop table EMP_TRI;
		purge recyclebin;

		create table EMP_TRI(
		    EMPNO number(4) primary key, 
		    ENAME varchar2(10), 
		    SAL number(7,2)
		);

        -- 트리거1: '사번만 입력'되면 자동으로 이름과 급여가 업데이트 되는 트리거 
		-- 트리거2: EMP_TRI에 insert가 될 때, 자동으로 EMP2에서 이름과 급여를 (EMP_TRI의 이름과 급여로) update 
		
	4) 자동 커밋
	   트리거는 auto commit 됨
	   
	5) 미션
	   tri_question.sql
	   

---

# < Modeling >

1. DB 모델링이란 ?
   현실세계의 업무프로세스를 분석해서 '실체(entity)'를 도출하고, 
   SW로 구현해내기 위한 '데이터구조'의 뼈대를 작성하는 업무 

2. 관계( Relation )
   (1) 관계에 대한 이해
       1) 예 - '고객' table 작성
           이름   아이디   핸드폰   주소   차넘버   차종   차명  년식 
	   ---------------------------------------------------------
	   홍길동  aa     1234   서울   a1234  승용차 소나타 1995
	   임꺽정  bb     2345   부산   NULL   NULL    NULL  NULL
	   이승엽  cc     3456   대전   NULL   NULL    NULL  NULL
	   한예슬  dd     4567   대구   d1234  승합차 갤로퍼 2001 
	   장동건  ee     5678   대구   NULL   NULL    NULL  NULL
	   한예슬  ff     6789   광주   f1234  미니벤 카렌스 1998 

    2) 예 - 고객 table 보기 변경 
	   이름   아이디   핸드폰   주소   차넘버  차종   차명  년식 
           ---------------------------------------------------------
           임꺽정  bb     2345   부산   NULL   NULL    NULL  NULL
           이승엽  cc     3456   대전   NULL   NULL    NULL  NULL
           장동건  ee     5678   대구   NULL   NULL    NULL  NULL
           한예슬  dd     4567   대구   d1234  승합차 갤로퍼 2001
           홍길동  aa     1234   서울   a1234  승용차 소나타 1995
           한예슬  ff     6789   광주   f1234  미니벤 카렌스 1998

        3) 분리   
		   <1> 레코드(ROW)를 기준
		      1> 테이블1(자동차를 소유하지 않은 '고객')
	                 이름  아이디  핸드폰  주소  
	               ----------------------------
	                 임꺽정  bb     2345   부산   
	                 이승엽  cc     3456   대전   
	                 장동건  ee     5678   대구 
	
	          2> 테이블2(자동차를 소유한 '고객')
	                 이름  아이디  핸드폰   주소   차넘버  차종   차명  년식 
	               -------------------------------------------------------
	                 한예슬  dd   4567   대구   d1234  승합차 갤로퍼 2001
	                 홍길동  aa   1234   서울   a1234  승용차 소나타 1995
	                 한예슬  ff   6789   광주   f1234  미니벤 카렌스 1998
	
	      <2> 컬럼(COLUMN)을 기준
		      1> 테이블1(개인신상'고객')
	                 이름  아이디    핸드폰   주소 
	                ----------------------------
	                 임꺽정  bb     2345   부산 
	                 이승엽  cc     3456   대전  
	                 장동건  ee     5678   대구  
	                 한예슬  dd     4567   대구   
	                 홍길동  aa     1234   서울   
	                 한예슬  ff     6789   광주
	
		     2> 테이블2('자동차')
	                 차넘버  차종   차명  년식        
	                ------------------------
	                 d1234  승합차 갤로퍼 2001    
	                 a1234  승용차 소나타 1995   
	                 f1234  미니벤 카렌스 1998  
                 
       4) 관계 (능동적으로 표현)
          <1> 부모 / 자식 테이블의 결정
	      1> 부서(dept)는 사원(emp)을 소유한다. (능동형)
	         -> 부모('부서' 테이블), 자식('사원' 테이블)
		 -> '사원'이 정의되기위해서는, '부서'가 먼저 정의되어야 함

		  2> 개인은 자동차를 소유한다. (능동형)
		 -> 부모('개인신상' 테이블), 자식('자동차' 테이블)
		 -> '자동차'정의되려면, '개인신상'이 먼저 정의 되어야 함 
          
	  <2> 공통컬럼의 요구 (2개의 테이블의 관계 형성) 
	      1> '개인신상'의 테이블의 아이디(PK)
	      2> '자동차'의 테이블의 아이디(FK)

	  <3> 공통 컬럼이 삽입된 테이블의 정의 ('틀림')
	      1> 테이블2('자동차') - '부모'  
                차넘버(PK) 차종   차명  년식
                ------------------------------
                d1234     승합차 갤로퍼 2001 
                a1234     승용차 소나타 1995 
                f1234     미니벤 카렌스 1998 
	      2> 테이블1(개인신상) - '자식'  
                이름  아이디(PK) 핸드폰     주소  차넘버(FK)
                -----------------------------------------
                임꺽정  bb        2345   부산   NULL 
                이승엽  cc        3456   대전   NULL
                장동건  ee        5678   대구   NULL 
                한예슬  dd        4567   대구   d1234
                홍길동  aa        1234   서울   a1234 
                한예슬  ff        6789   광주   f1234
	   <4> 공통 컬럼이 삽입된 테이블의 정의 ('옮음')
	      1> 테이블1(개인신상) - '부모' 
                  이름  아이디(PK) 핸드폰 주소 
                  ----------------------------
                  임꺽정  bb        2345   부산 
                  이승엽  cc        3456   대전  
                  장동건  ee        5678   대구 
                  한예슬  dd        4567   대구   
                  홍길동  aa        1234   서울   
                  한예슬  ff        6789   광주
	      2> 테이블2(자동차) - '자식' 
                  차넘버(PK)  차종   차명  년식  아이디(FK)
                  -------------------------------------
                  d1234     승합차  갤로퍼 2001   dd
		  d1235     승합차  테슬라 2024   dd --추가될 수 있음
                  a1234     승용차  소나타 1995   aa
                  f1234     미니벤  카렌스 1998   ff
	    Q) '홍길동'의 자동차의 차넘버를 SELECT 하라
	      Sub> select ID from MEMBER where NAME='홍길동';
	      Main> select m.NAME, c.NUM from MEMBER m, Car c
	           where c.ID=(select ID from MEMBER where NAME='홍길동');

   (2) 관계의 종류 
      1) Cardinality 관점
         <1> 일대일(1:1) : 모델링 가능 
		     ex) 부서 / 부서장 
		 <2> 일대다(1:N) : 모델링 가능 
		     ex) 부서 / 사원 
         <3> 다대다(N:N) : 모델링 '불가능'
		     ex) 고객 / 상품
             cf) 다대다 관계의 '해소' # 
	         -> N:N는 1:N으로 변경('중간테이블')해서 모델링해야 함
		     ex1) 고객 / 상품
                1> 테이블1(고객) - '부모' 
	            이름    ID(PK)   핸드폰 
	            -----------------------------
	            홍길동  hong      011-123-1234
	            이순신  lee       019-456-4567
		2> 테이블2(상품) - '부모' 
	            상품ID(PK) 이름    회사번호  가격      
	            -----------------------------
	            P0001    새우깡  농심      1200         
	            P0002    맛동산  해태       700
		3> 테이블3(구매) - '자식'
		   구매번호(PK)  ID(FK)  상품ID(FK)   구매일자 
		   ---------------------------------------
		   001         hong    P0001    2025/01/06
		   002         hong    P0002    2025/01/07
		   003         lee     P0001    2025/01/05
	     
            ex2) 학생 / 동아리 
		    ex3) 학생 / 과목 
		    ex4) 공장 / 제품
	       ... 

      2) Relationship Type 관점
         <1> 식별관계( Identifying )    
		    1> 정의: 부모의 PK컬럼이 자식의 'PK'컬럼으로 전이되는 관계 
		    2> 무조건 No nulls

		 <2> 비식별관계( Non-Identifying ) 
		    1> 정의: 부모의 PK컬럼이 자식의 '일반'컬럼으로 전이되는 관계
		    2> 2개중 택일 
		       - Null Allowed 
		       - No nulls


## < 정규화 / 비정규화 >

1) 정규화 ( Normalization )
	- 1정규화 : '한 컬럼'에 여러 개의 속성값을 넣지마!
		  ex) 고객
			 연락처: 번호1, 번호2, ...
			 
	- 2정규화 : 일반 속성은 'PK속성들 전체에 종속'돼야 해!
		  ex) 주문
			  PK(상품ID + 고객ID) / 고객주소(X)
	- 3정규화 : 일반속성끼리는 '종속'관계가 있으면 안돼!
		  ex) 주문
			  PK( 주문번호 ) / ( 고객번호, 고객명(X) )
2) 비정규화 ( Denormalization )
	- 테이블 '합치기'를 통해 '중복'과 'null'을 일부 허용
	- '새 테이블 생성'( ex: 일/월/년 매출 결산 / 통계 테이블 )

